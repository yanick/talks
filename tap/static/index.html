<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>Drinking from the TAP</title>
          <meta property="og:title" content="Drinking from the TAP">
          <meta property="og:type" content="website">
          <meta property="og:image" content="https://yanick.github.io/talks/tap/featured-slide.jpg">
          <meta property="og:url" content="https://yanick.github.io/talks/tap">
        <link rel="stylesheet" href="./css/reveal.css">
        <link rel="stylesheet" href="./css/theme/black.css" id="theme">
        <link rel="stylesheet" href="./css/highlight/zenburn.css">
        <link rel="stylesheet" href="./css/print/paper.css" type="text/css" media="print">
          <link rel="stylesheet" href="./assets/./trimmings/style.css">


    </head>
    <body>

        <div class="reveal">
            <div class="slides"><section  data-markdown><script type="text/template">

<!-- .slide: data-background-image="./public/tap.png" -->
<!-- .slide: data-background-opacity="0.35" -->
<!-- .slide: data-background-position="left 20px" -->
<!-- .slide: data-background-size="800px" -->

<footer>
<object 
	class="logo"
	data="./public/github.svg" type="image/svg+xml">
</object> [yanick](https://github.com/yanick) <object 
	class="logo"
	data="./public/twitter.svg" type="image/svg+xml">
</object> [yenzie](https://twitter.com/yenzie)
</footer>

<h2>Drinking from the TAP</h2>

Yanick Champoux 

<object 
	class="logo"
	data="./public/github.svg" type="image/svg+xml">
</object> [yanick](https://github.com/yanick) <object 
	class="logo"
	data="./public/twitter.svg" type="image/svg+xml">
</object> [yenzie](https://twitter.com/yenzie)

for Toronto.pm, November 29th, 2018

</script></section><section  data-markdown><script type="text/template">

# TAP 

</script></section><section  data-markdown><script type="text/template">

## [Test Anything Protocol](https://testanything.org/)

</script></section><section  data-markdown><script type="text/template">



<pre><code data-trim data-noescape class='tap'>
1..3
ok&nbsp;1
ok&nbsp;2&nbsp;-&nbsp;does&nbsp;the&nbsp;thing
not&nbsp;ok&nbsp;3&nbsp;-&nbsp;does&nbsp;it&nbsp;well
&nbsp;&nbsp;&nbsp;&nbsp;&#35;&nbsp;&nbsp;&nbsp;Failed&nbsp;test&nbsp;'does&nbsp;it&nbsp;well'
&nbsp;&nbsp;&nbsp;&nbsp;&#35;&nbsp;&nbsp;&nbsp;at&nbsp;lab/test.t&nbsp;line&nbsp;9.
&#35;&nbsp;Looks&nbsp;like&nbsp;you&nbsp;failed&nbsp;1&nbsp;test&nbsp;of&nbsp;3.
</code></pre>

<p class="fragment current-only" data-code-focus="1">test plan</p>
<p class="fragment current-only" data-code-focus="2">success. :-) </p>
<p class="fragment current-only" data-code-focus="3">with description! 8-D</p>
<p class="fragment current-only" data-code-focus="4">failed :-(</p>
<p class="fragment current-only" data-code-focus="5-7">comments</p>

</script></section><section  data-markdown><script type="text/template">

## subtest 

	# Subtest: group of test
		ok 1 - yay
		not ok 2 - oh my
		#   Failed test 'oh my'
		#   at lab/test.t line 9.
		1..2
		# Looks like you failed 1 test of 2.
	not ok 4 - group of test
	#   Failed test 'group of test'
	#   at lab/test.t line 10.

<p class="fragment current-only" data-code-focus="2-7">sub-stream</p>
<p class="fragment current-only" data-code-focus="1,8">aggregate result</p>

</script></section><section  data-markdown><script type="text/template">

## todo

	not ok 5 - does that other thing # TODO not implemented yet
	#   Failed (TODO) test 'does that other thing'
	#   at lab/test.t line 14.

</script></section><section  data-markdown><script type="text/template">

## skipping

<pre><code data-trim data-noescape class=''>
ok&nbsp;6&nbsp;&#35;&nbsp;skip&nbsp;windows&nbsp;only
</code></pre>

</script></section><section  data-markdown><script type="text/template">

## Write our first test
 
</script></section><section  data-markdown><script type="text/template">

##  `./t/basic.t`

</script></section><section  data-markdown><script type="text/template">



<pre><code data-trim data-noescape class=''>
use&nbsp;Test::More&nbsp;tests&nbsp;=>&nbsp;1;

if&nbsp;(&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;2&nbsp;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;"success!";
}
else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;"oh&nbsp;noes";
}

</code></pre>

<pre><code data-trim data-noescape class=''>
1..1
ok&nbsp;1&nbsp;-&nbsp;success!
</code></pre>

</script></section><section  data-markdown><script type="text/template">



<pre><code data-trim data-noescape class=''>
use&nbsp;Test::More&nbsp;tests&nbsp;=>&nbsp;1;

if&nbsp;(&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;3&nbsp;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;"success!";
}
else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;"oh&nbsp;noes";
}
</code></pre>

<pre><code data-trim data-noescape class=''>
1..1
not&nbsp;ok&nbsp;1&nbsp;-&nbsp;oh&nbsp;noes
&#35;&nbsp;&nbsp;&nbsp;Failed&nbsp;test&nbsp;'oh&nbsp;noes'
&#35;&nbsp;&nbsp;&nbsp;at&nbsp;t/basic.t&nbsp;line&nbsp;7.
&#35;&nbsp;Looks&nbsp;like&nbsp;you&nbsp;failed&nbsp;1&nbsp;test&nbsp;of&nbsp;1.
</code></pre>

</script></section><section ><section data-markdown><script type="text/template">



<pre><code data-trim data-noescape class=''>
use&nbsp;Test::More&nbsp;tests&nbsp;=>&nbsp;2;

if&nbsp;(&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;3&nbsp;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;"success!";
}
else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;"oh&nbsp;noes";
}
</code></pre>

<pre><code data-trim data-noescape class=''>
1..2
ok&nbsp;1&nbsp;-&nbsp;success!
&#35;&nbsp;Looks&nbsp;like&nbsp;you&nbsp;planned&nbsp;2&nbsp;tests&nbsp;but&nbsp;ran&nbsp;1.
</code></pre>

</script></section><section data-markdown><script type="text/template">



<pre><code data-trim data-noescape class=''>
use&nbsp;Test::More;

plan&nbsp;tests&nbsp;=>&nbsp;2;

if&nbsp;(&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;3&nbsp;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;"success!";
}
else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;"oh&nbsp;noes";
}
</code></pre>

</script></section><section data-markdown><script type="text/template">



<pre><code data-trim data-noescape class=''>
use&nbsp;Test::More;

if&nbsp;(&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;3&nbsp;)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;pass&nbsp;"success!";
}
else&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;fail&nbsp;"oh&nbsp;noes";
}

done_testing;
</code></pre>

<pre><code data-trim data-noescape class=''>
ok&nbsp;1&nbsp;-&nbsp;success!
1..1

</code></pre>

</script></section></section><section  data-markdown><script type="text/template">

## sugar time

</script></section><section  data-markdown><script type="text/template">

## ok 

<pre><code data-trim data-noescape class=''>
ok&nbsp;1&nbsp;+&nbsp;1&nbsp;==&nbsp;2,&nbsp;"math&nbsp;works";
ok&nbsp;1&nbsp;+&nbsp;7&nbsp;==&nbsp;10,&nbsp;"it's&nbsp;in&nbsp;hex,&nbsp;right?";
</code></pre>

	ok 1 - math works
	not ok 2 - it's in hex, right?
	#   Failed test 'it's in hex, right?'
	#   at t/basic.t line 4.
	1..2
	# Looks like you failed 1 test of 2.


</script></section><section  data-markdown><script type="text/template">

## is

<pre><code data-trim data-noescape class=''>
is&nbsp;1&nbsp;+&nbsp;1&nbsp;=>&nbsp;2,&nbsp;"math&nbsp;works";
is&nbsp;1&nbsp;+&nbsp;7&nbsp;=>&nbsp;10,&nbsp;"it's&nbsp;in&nbsp;hex,&nbsp;right?";
</code></pre>

	ok 1 - math works
	not ok 2 - it's in hex, right?
	#   Failed test 'it's in hex, right?'
	#   at t/basic.t line 4.
	#		  got: '8'
	#	 expected: '10'

</script></section><section  data-markdown><script type="text/template">

## isnt

<pre><code data-trim data-noescape class=''>
isnt&nbsp;"what&nbsp;it&nbsp;seems"&nbsp;=>&nbsp;"what&nbsp;it&nbsp;seems";
</code></pre>

	#   Failed test at t/basic.t line 3.
	#		  got: 'what it seems'
	#	 expected: anything else


</script></section><section  data-markdown><script type="text/template">

## cmp_ok


<pre><code data-trim data-noescape class=''>
cmp_ok&nbsp;1&nbsp;+&nbsp;3,&nbsp;'>',&nbsp;5,&nbsp;&nbsp;"13&nbsp;>&nbsp;5,&nbsp;obviously";
</code></pre>

	not ok 1 - 13 > 5, obviously
	#   Failed test '13 > 5, obviously'
	#   at t/basic.t line 3.
	#	 '4'
	#		 >
	#	 '5'

</script></section><section  data-markdown><script type="text/template">

## like / unlike

<pre><code data-trim data-noescape class=''>
like&nbsp;$talk,&nbsp;qr/TAP/,&nbsp;"I&nbsp;mention&nbsp;TAP";
</code></pre>

</script></section><section  data-markdown><script type="text/template">

## is_deeply

<pre><code data-trim data-noescape class=''>
is_deeply&nbsp;$struct,&nbsp;{&nbsp;foo&nbsp;=>&nbsp;[&nbsp;'bar',&nbsp;'baz'&nbsp;]&nbsp;};
</code></pre>

</script></section><section  data-markdown><script type="text/template">

## subtests

<pre><code data-trim data-noescape class=''>
subtest&nbsp;"group&nbsp;name"&nbsp;=>&nbsp;sub&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;plan&nbsp;tests&nbsp;=>&nbsp;2;

&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;foo();
&nbsp;&nbsp;&nbsp;&nbsp;like&nbsp;bar(),&nbsp;qr/something/;
};
</code></pre>

if no plan, implicit 'done_testing';

</script></section><section  data-markdown><script type="text/template">

## diag / explain 

<pre><code data-trim data-noescape class=''>
my&nbsp;$struct&nbsp;=&nbsp;[&nbsp;1,0,2&nbsp;];
ok&nbsp;foo($struct)
&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;diag&nbsp;"the&nbsp;input&nbsp;is&nbsp;",&nbsp;explain&nbsp;$struct;
</code></pre>


	not ok 1
	#   Failed test at t/basic.t line 6.
	# the input is [
	#   1,
	#   0,
	#   2
	# ]


</script></section><section  data-markdown><script type="text/template">

## todo 

<pre><code data-trim data-noescape class=''>
{
&nbsp;&nbsp;&nbsp;&nbsp;local&nbsp;$TODO&nbsp;=&nbsp;"bug,&nbsp;see&nbsp;GH&#35;123";
&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;foo(),&nbsp;"should&nbsp;return&nbsp;a&nbsp;true&nbsp;value";
}
</code></pre>


</script></section><section  data-markdown><script type="text/template">

## skip 

<pre><code data-trim data-noescape class=''>
SKIP&nbsp;:&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;skip&nbsp;"doesn't&nbsp;work&nbsp;on&nbsp;Sunday",&nbsp;2&nbsp;unless&nbsp;(localtime)[3];&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;foo();
&nbsp;&nbsp;&nbsp;&nbsp;ok&nbsp;bar();
}
</code></pre>

</script></section><section  data-markdown><script type="text/template">

## How to run it?

	perl t/basic.t 

</script></section><section  data-markdown><script type="text/template">

## `prove`

	$ prove -l t

	$ perl -I lib t/**.t

</script></section><section  data-markdown><script type="text/template">

## parallel runs 

	$ prove -j4 -l t

</script></section><section ><section data-markdown><script type="text/template">

## state 

	$ prove --state=save -l t

	$ prove --state=failed,save

save, last, failed, passed, all 

hot, todo 

slow, fast 

new, old, fresh 

</script></section><section data-markdown><script type="text/template">



	$ prove --state=hot,new,fast,save


</script></section></section><section  data-markdown><script type="text/template">

## Useful Test::* modules 


</script></section><section  data-markdown><script type="text/template">

### Test::Deep

	use Test::Deep;

	cmp_deeply(
		$thing,
		{
			foo  => superhashof({ quux => 1 }),
			bar => [ "a", ignore() ],
		},
	)

</script></section><section  data-markdown><script type="text/template">

### Test::Exception

	use Test::Exception;

	throws_ok {
		$foo->go_kabloomey;
	} qr/KA-BLO+M/, 'goes boom';

</script></section><section  data-markdown><script type="text/template">

### Test::Warnings 

	use Test::Warnings;

	ok 'yay';

	done_testing;

&nbsp;

		ok 1 - yay!
		ok 2 - no (unexpected) warnings (via done_testing)
		1..2

</script></section><section  data-markdown><script type="text/template">

### Test::Perl::Critic::Progressive 

	use Test::Perl::Critic::Progressive
		qw( progressive_critic_ok );

	progressive_critic_ok();

</script></section><section  data-markdown><script type="text/template">

### Test::WWW::Mechanize

<pre><code data-trim data-noescape class=''>
use&nbsp;Test::WWW::Mechanize;

my&nbsp;$agent&nbsp;=&nbsp;Test::WWW::Mechanize->new'

$agent->get_ok(&nbsp;'http://techblog.babyl.ca'&nbsp;);
$agent->title_like(&nbsp;qr/hacking&nbsp;thy&nbsp;fearful&nbsp;symmetry/&nbsp;);

</code></pre>


</script></section><section  data-markdown><script type="text/template">

## Mocking 

</script></section><section  data-markdown><script type="text/template">

### Test::MockObject

	  use Test::MockObject;

	  my $mock = Test::MockObject->new;

	  $mock->set_true( 'is_foo')
		   ->set_false( 'does_bar' )
		   ->set_series( 'quux', 'a', 'b', 'c' );

</script></section><section  data-markdown><script type="text/template">

### Test::MockObject::Extends;

	my $faked = Test::MockObject::Extends->new( $object );

	$faked->set_true( 'fetch_from_network' );
	$faked->set_always( 'readdir', [  './a.txt' ] );

</script></section><section  data-markdown><script type="text/template">

### Test::Class::Moose

	package TestsFor::MyThing;

	use Test::Class::Moose;

	has fixture => (
		is => 'ro',
		default => sub {
			...
		},
	);
	
	sub foo($test) :Tests(1) {
		ok $fixture->quux;
	}
	


</script></section><section  data-markdown><script type="text/template">

## THANK YOU

Questions?


[TAP]: https://testanything.org/

<script src="./public/reveal-code-focus.js">__SCRIPT_END__
</script></section></div>
        </div>

        <script src="./lib/js/head.min.js"></script>
        <script src="./js/reveal.js"></script>

        <script>
            function extend() {
              var target = {};
              for (var i = 0; i < arguments.length; i++) {
                var source = arguments[i];
                for (var key in source) {
                  if (source.hasOwnProperty(key)) {
                    target[key] = source[key];
                  }
                }
              }
              return target;
            }

            // Optional libraries used to extend on reveal.js
            var deps = [
              { src: './lib/js/classList.js', condition: function() { return !document.body.classList; } },
              { src: './plugin/markdown/marked.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/markdown/markdown.js', condition: function() { return !!document.querySelector('[data-markdown]'); } },
              { src: './plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
              { src: './plugin/zoom-js/zoom.js', async: true },
              { src: './plugin/notes/notes.js', async: true },
              { src: './plugin/math/math.js', async: true }
            ];

            // default options to init reveal.js
            var defaultOptions = {
              controls: true,
              progress: true,
              history: true,
              center: true,
              transition: 'default', // none/fade/slide/convex/concave/zoom
              dependencies: deps
            };

            // options from URL query string
            var queryOptions = Reveal.getQueryHash() || {};

            var options = {"dependencies":[{"src":"public/revealjs/lib/js/classList.js"},{"src":"public/revealjs/plugin/markdown/marked.js"},{"src":"public/revealjs/plugin/markdown/markdown.js"},{"src":"public/revealjs/plugin/zoom-js/zoom.js","async":true},{"src":"public/revealjs/plugin/notes/notes.js","async":true},{"src":"public/highlight.js"},{"src":"public/reveal-code-focus.js"}]};
            options = extend(defaultOptions, options, queryOptions);
        </script>

          <script src="./assets/./trimmings/footer.js"></script>

        <script>
          Reveal.initialize(options);
        </script>
    </body>
</html>
